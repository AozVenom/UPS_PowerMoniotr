{
  "upload_manifest": {
    "timestamp": "{{ ansible_date_time.iso8601 }}",
    "hostname": "{{ ansible_hostname }}",
    "session_id": "{{ ansible_date_time.epoch }}",
    "jfrog_repository": "{{ jfrog_repository }}",
    "uploaded_by": "Ansible UPS Monitoring System"
  },
  "uploaded_files": [
{% for result in upload_results %}
    {
      "local_file": "{{ result.item }}",
      "remote_url": "{{ result.url | default('N/A') }}",
      "upload_status": "{{ 'success' if result.status in [200, 201] else 'failed' }}",
      "status_code": {{ result.status | default(0) }},
      "file_size": "{{ result.content_length | default('unknown') }}",
      "upload_time": "{{ result.date | default(ansible_date_time.iso8601) }}"
    }{% if not loop.last %},{% endif %}
{% endfor %}
  ],
  "configuration_upload": {
    "status": "{{ 'success' if config_upload.status in [200, 201] else 'failed' }}",
    "config_file": "ups_monitoring_{{ ansible_date_time.date }}.yml",
    "remote_url": "{{ config_upload.url | default('N/A') }}"
  },
  "summary": {
    "total_files": {{ upload_results | length }},
    "successful_uploads": {{ upload_results | selectattr('status', 'in', [200, 201]) | list | length }},
    "failed_uploads": {{ upload_results | rejectattr('status', 'in', [200, 201]) | list | length }}
  }
}
